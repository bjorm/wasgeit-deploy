version: '3.3'
services:
  crawler:
    image: wasgeit/crawler
    user: 1000:1000
    volumes:
    - type: bind
      source: ./db
      target: /wasgeit/db
  server:
    image: wasgeit/server
    user: 1000:1000
    networks:
    - wasgeit
    volumes:
    - type: bind
      source: ./db
      target: /wasgeit/db
  frontend:
    image: wasgeit/frontend
    command: "nginx -g 'daemon off;'"
    environment:
      - VIRTUAL_HOST=wasgeit.ch,www.wasgeit.ch
      - ENABLE_IPV6=true
    depends_on:
    - server
    networks:
    - wasgeit
    ports:
    - 80:80
    - 443:443
    volumes:
    - /var/log/nginx/:/var/log/nginx

networks:
  wasgeit:
